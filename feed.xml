<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mauricio Jost</title>
    <description></description>
    <link>http://mauriciojost.github.io/</link>
    <atom:link href="http://mauriciojost.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sat, 21 Oct 2017 04:30:31 +0200</pubDate>
    <lastBuildDate>Sat, 21 Oct 2017 04:30:31 +0200</lastBuildDate>
    <generator>Jekyll v3.6.0</generator>
    
      <item>
        <title>Writing a post or a presentation? Both!</title>
        <description>&lt;h1 id=&quot;post-or-slides&quot;&gt;Post or slides?&lt;/h1&gt;

&lt;p&gt;Presentations are great. Blogs too. Which one should do I dedicate my time to?&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;p&gt;No need to choose, you can do &lt;strong&gt;both at once&lt;/strong&gt;!&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;p&gt;In this special &lt;strong&gt;post/presentation&lt;/strong&gt;, I will give you an example with sources
on how to build your own blog posts, and generate both:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;a post, and&lt;/li&gt;
&lt;li&gt;a presentation&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;from a single &lt;code&gt;markdown&lt;/code&gt; file.&lt;/p&gt;

&lt;!--more--&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;first-slide&quot;&gt;First slide&lt;/h1&gt;

&lt;p&gt;This is an example of an horizontal slide.&lt;/p&gt;

&lt;p&gt;Text written here appears in both the presentation and the post layouts.&lt;/p&gt;

&lt;p&gt;Press &lt;code&gt;ESC&lt;/code&gt; to navigate over all the slides.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;You can have text that will be ignored in the presentation, but written in the
post, so you can go more into details where it really matters.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;second-slide&quot;&gt;Second slide&lt;/h1&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-a&quot;&gt;Second slide (A)&lt;/h2&gt;

&lt;p&gt;You can add a vertical slide (I personally use them for continuation of the upper slide).&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-b&quot;&gt;Second slide B&lt;/h2&gt;

&lt;p&gt;Yet another one.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-c&quot;&gt;Second slide C&lt;/h2&gt;

&lt;p&gt;Last one including a figure from &lt;code&gt;Gravizo&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20Example%20of%20a%20figure%20using%20Gravizo;%0Ascale%20max%20900%20width;%0Arectangle%20MARKDOWN;%0Arectangle%20BLOG%20%7B;%0A%20%20rectangle%20POST;%0A%20%20rectangle%20PRESENTATION;%0A%7D;%0AMARKDOWN%20--%3E%20POST;%0AMARKDOWN%20--%3E%20PRESENTATION;%0Anote%20left%20of%20MARKDOWN:%20example;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;

&lt;p&gt;Here you can find:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/presentation.html&quot;&gt;The generated presentation / slides&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/post.html&quot;&gt;The generated blog post&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://raw.githubusercontent.com/mauriciojost/mauriciojost.github.io/development/_posts/2017-10-10-covariant-contravariant-invariant-in-scala.markdown&quot;&gt;The source markgown file&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll official page&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/hakimel/reveal.js/&quot;&gt;Reveal.js official git repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;

&lt;p&gt;And &lt;a href=&quot;https://github.com/mauriciojost/mauriciojost.github.io&quot;&gt;star the project here&lt;/a&gt; if you liked it!&lt;/p&gt;
</description>
        <pubDate>Mon, 16 Oct 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/post.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/post.html</guid>
        
        <category>reveal</category>
        
        <category>blog</category>
        
        <category>markdown</category>
        
        
      </item>
    
      <item>
        <title>Writing a post or a presentation? Both!</title>
        <description>&lt;h1 id=&quot;post-or-slides&quot;&gt;Post or slides?&lt;/h1&gt;

&lt;p&gt;Presentations are great. Blogs too. Which one should do I dedicate my time to?&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;p&gt;No need to choose, you can do &lt;strong&gt;both at once&lt;/strong&gt;!&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;p&gt;In this special &lt;strong&gt;post/presentation&lt;/strong&gt;, I will give you an example with sources
on how to build your own blog posts, and generate both:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;a post, and&lt;/li&gt;
&lt;li&gt;a presentation&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;from a single &lt;code&gt;markdown&lt;/code&gt; file.&lt;/p&gt;

&lt;!--more--&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;first-slide&quot;&gt;First slide&lt;/h1&gt;

&lt;p&gt;This is an example of an horizontal slide.&lt;/p&gt;

&lt;p&gt;Text written here appears in both the presentation and the post layouts.&lt;/p&gt;

&lt;p&gt;Press &lt;code&gt;ESC&lt;/code&gt; to navigate over all the slides.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;You can have text that will be ignored in the presentation, but written in the
post, so you can go more into details where it really matters.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;second-slide&quot;&gt;Second slide&lt;/h1&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-a&quot;&gt;Second slide (A)&lt;/h2&gt;

&lt;p&gt;You can add a vertical slide (I personally use them for continuation of the upper slide).&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-b&quot;&gt;Second slide B&lt;/h2&gt;

&lt;p&gt;Yet another one.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h2 id=&quot;second-slide-c&quot;&gt;Second slide C&lt;/h2&gt;

&lt;p&gt;Last one including a figure from &lt;code&gt;Gravizo&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20Example%20of%20a%20figure%20using%20Gravizo;%0Ascale%20max%20900%20width;%0Arectangle%20MARKDOWN;%0Arectangle%20BLOG%20%7B;%0A%20%20rectangle%20POST;%0A%20%20rectangle%20PRESENTATION;%0A%7D;%0AMARKDOWN%20--%3E%20POST;%0AMARKDOWN%20--%3E%20PRESENTATION;%0Anote%20left%20of%20MARKDOWN:%20example;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;

&lt;p&gt;Here you can find:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/presentation.html&quot;&gt;The generated presentation / slides&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/post.html&quot;&gt;The generated blog post&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://raw.githubusercontent.com/mauriciojost/mauriciojost.github.io/development/_posts/2017-10-10-covariant-contravariant-invariant-in-scala.markdown&quot;&gt;The source markgown file&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll official page&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/hakimel/reveal.js/&quot;&gt;Reveal.js official git repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;

&lt;p&gt;And &lt;a href=&quot;https://github.com/mauriciojost/mauriciojost.github.io&quot;&gt;star the project here&lt;/a&gt; if you liked it!&lt;/p&gt;
</description>
        <pubDate>Mon, 16 Oct 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/presentation.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/10/16/howto-post-and-presentation/presentation.html</guid>
        
        <category>reveal</category>
        
        <category>blog</category>
        
        <category>markdown</category>
        
        
      </item>
    
      <item>
        <title>CoVariant, ContraVariant and InVariant... Variances in Scala</title>
        <description>&lt;h2 id=&quot;variance&quot;&gt;Variance&lt;/h2&gt;

&lt;p&gt;The variance in Scala aims to provide flexibility to the inheritance on parametric types.&lt;/p&gt;

&lt;p&gt;It addresses cases like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;List[Dog]&lt;/code&gt; a subtype &lt;code&gt;List[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;X=&amp;gt;Boolean&lt;/code&gt; a subtype of &lt;code&gt;X=&amp;gt;AnyVal&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;a-concrete-example&quot;&gt;A concrete example&lt;/h3&gt;

&lt;p&gt;Consider the following example:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20Example%20types;%0Ascale%20max%20900%20width;%0AAnimal%20%3C%7C--%20Dog;%0AAnimal%20%3C%7C--%20Cat;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// Our pet classes
sealed class Animal
class Dog extends Animal
class Cat extends Animal
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;Let&amp;#39;s say you work for a veterinary. You&amp;#39;re writing an API.&lt;/p&gt;

&lt;p&gt;You want to &lt;strong&gt;modularize the functions
that retrieve pets&amp;#39; information from a DB&lt;/strong&gt;, like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getBreed&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Then, we could define a class &lt;code&gt;Func&lt;/code&gt; that will encapsulate an
&lt;em&gt;information retriever&lt;/em&gt; function, &lt;code&gt;f&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Here is our first attempt:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;class Func[I,O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;Good! We can define our first instance of &lt;code&gt;Func&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// Our first information retriever
// Is my animal a dog?
val isADog: Func[Animal, Boolean] = {
  new Func((i: Animal) =&amp;gt; i.isInstanceOf[Dog])
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;p&gt;We say that &lt;strong&gt;&lt;em&gt;Fun&lt;/em&gt; is invariant in &lt;code&gt;I&lt;/code&gt; (&lt;code&gt;Animal&lt;/code&gt;) and invariant in &lt;code&gt;O&lt;/code&gt; (&lt;code&gt;Boolean&lt;/code&gt;)&lt;/strong&gt;, as there is not subtype association
done by the compiler.&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;generalizing-func-covariance&quot;&gt;Generalizing &lt;code&gt;Func&lt;/code&gt;: Covariance&lt;/h2&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-problem&quot;&gt;The problem&lt;/h3&gt;

&lt;p&gt;Let&amp;#39;s say you handle many &lt;code&gt;Func&lt;/code&gt; implementations:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val x:  Func[Animal, Boolean] = ...
val y:  Func[Animal, String] = ...
val z:  Func[Animal, Int] = ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;It would be good to be able to treat all &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt; and &lt;code&gt;z&lt;/code&gt; polymorphically.&lt;/p&gt;

&lt;p&gt;For instance be able to do:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val l: List[Func[Animal, AnyVal]] =
   List(x, y, z) // won't work, invariance
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Our initial declaration of &lt;code&gt;Func[I, O]&lt;/code&gt; was invariant in both &lt;code&gt;I&lt;/code&gt; and &lt;code&gt;O&lt;/code&gt;.
It &lt;strong&gt;does not allow this supertype relation&lt;/strong&gt;.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The solution&lt;/h3&gt;

&lt;p&gt;The solution is &lt;strong&gt;covariance&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The principle: making &lt;code&gt;Clz&lt;/code&gt; covariant in &lt;code&gt;A&lt;/code&gt; means that&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Cat &amp;lt;: Animal&lt;/code&gt; implies&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Clz[Cat] &amp;lt;: Clz[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In other words: the inheritance of this &lt;strong&gt;parametric&lt;/strong&gt; type follows the one from the &lt;strong&gt;parameter&lt;/strong&gt; type.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Back to our example, we simply re-define &lt;code&gt;Func&lt;/code&gt;, but making it covariant in &lt;code&gt;O&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// now covariant on O
class Func[I, +O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// specific type
val isADog: Func[Animal, Boolean] = ...

// generic type
val covIsDogForAnyVal: Func[Animal, AnyVal] =
        isADog   // assigned to a more general type
                 // works because
                 // Boolean &amp;lt;: AnyVal,
                 // and thanks to covariance
                 // Func[X, Boolean] &amp;lt;: Func[X, AnyVal]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;h2 id=&quot;specializing-func-contravariance&quot;&gt;Specializing &lt;code&gt;Func&lt;/code&gt;: Contravariance&lt;/h2&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-problem&quot;&gt;The problem&lt;/h3&gt;

&lt;p&gt;Let&amp;#39;s say we have our function &lt;code&gt;Func[Animal, Boolean]&lt;/code&gt;. Given that &lt;code&gt;Dog &amp;lt;: Animal&lt;/code&gt; (&lt;code&gt;Dog&lt;/code&gt; is a subtype of &lt;code&gt;Animal&lt;/code&gt;),
it seems natural to be able to apply such function to a &lt;code&gt;Dog&lt;/code&gt; too.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The solution&lt;/h3&gt;

&lt;p&gt;The solution is &lt;strong&gt;contravariance&lt;/strong&gt;.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;The principle: making &lt;code&gt;Clz&lt;/code&gt; contravariant in &lt;code&gt;A&lt;/code&gt; means that:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Cat &amp;lt;: Animal&lt;/code&gt; implies&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Clz[Cat] &amp;gt;: Clz[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In other words the inheritance of this parametric type follows
inversely the one from the parameter type.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;We simply redefine &lt;code&gt;Func&lt;/code&gt; but making it contravariant in &lt;code&gt;I&lt;/code&gt; this time:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// now contravariant in I
class Func[-I, O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// generic type
val isDog: Func[Animal, Boolean] =
        new Func((i: Animal) =&amp;gt; i.isInstanceOf[Dog])

// specific type
val contrvarIsDog: Func[Dog, Boolean] =
        isDog // assigned to a more specific type
              // works because
              // Dog &amp;lt;: Animal, and thanks
              // to contravariance
              // Func[Dog, X] &amp;gt;: Func[Animal, X]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;This is the result of applying variances:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%202.%20Covariance%20and%20Contravariance;%0Ascale%20max%20900%20width;%0A%22List%5BAnimal%5D%22%20%3C%7C--%20%22List%5BDog%5D%22:%20%22Covariance%20%5B+A%5D%22;%0A%22List%5BAnimal%5D%22%20%3C%7C--%20%22List%5BCat%5D%22;%0A%22Funct%5BDog%5D%22%20%3C%7C--%20%22Funct%5BAnimal%5D%22:%20%22Contravariance%20%5B-A%5D%22;%0Anote%20left%20of%20%22Funct%5BAnimal%5D%22:%20When%20instanciated,%5Cncan%20be%20reused%5Cnas%20Funct%5BDog%5D%5Cnthanks%20to%5Cncontravariance;%0Anote%20right%20of%20%22List%5BDog%5D%22:%20Can%20be%20added%5Cnto%20a%20List%5BAnimal%5D%5Cnthanks%20to%5Cncovariance;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;See the &lt;a href=&quot;https://docs.scala-lang.org/tour/variances.html&quot;&gt;official Scala documentation on variance&lt;/a&gt;.&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;
</description>
        <pubDate>Tue, 10 Oct 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/10/10/covariant-contravariant-invariant-in-scala/post.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/10/10/covariant-contravariant-invariant-in-scala/post.html</guid>
        
        <category>scala</category>
        
        <category>types</category>
        
        <category>covariant</category>
        
        <category>contravariant</category>
        
        <category>invariant</category>
        
        
      </item>
    
      <item>
        <title>CoVariant, ContraVariant and InVariant... Variances in Scala</title>
        <description>&lt;h2 id=&quot;variance&quot;&gt;Variance&lt;/h2&gt;

&lt;p&gt;The variance in Scala aims to provide flexibility to the inheritance on parametric types.&lt;/p&gt;

&lt;p&gt;It addresses cases like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;List[Dog]&lt;/code&gt; a subtype &lt;code&gt;List[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;X=&amp;gt;Boolean&lt;/code&gt; a subtype of &lt;code&gt;X=&amp;gt;AnyVal&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;a-concrete-example&quot;&gt;A concrete example&lt;/h3&gt;

&lt;p&gt;Consider the following example:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20Example%20types;%0Ascale%20max%20900%20width;%0AAnimal%20%3C%7C--%20Dog;%0AAnimal%20%3C%7C--%20Cat;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// Our pet classes
sealed class Animal
class Dog extends Animal
class Cat extends Animal
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;Let&amp;#39;s say you work for a veterinary. You&amp;#39;re writing an API.&lt;/p&gt;

&lt;p&gt;You want to &lt;strong&gt;modularize the functions
that retrieve pets&amp;#39; information from a DB&lt;/strong&gt;, like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;getName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getBreed&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Then, we could define a class &lt;code&gt;Func&lt;/code&gt; that will encapsulate an
&lt;em&gt;information retriever&lt;/em&gt; function, &lt;code&gt;f&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Here is our first attempt:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;class Func[I,O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;Good! We can define our first instance of &lt;code&gt;Func&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// Our first information retriever
// Is my animal a dog?
val isADog: Func[Animal, Boolean] = {
  new Func((i: Animal) =&amp;gt; i.isInstanceOf[Dog])
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;p&gt;We say that &lt;strong&gt;&lt;em&gt;Fun&lt;/em&gt; is invariant in &lt;code&gt;I&lt;/code&gt; (&lt;code&gt;Animal&lt;/code&gt;) and invariant in &lt;code&gt;O&lt;/code&gt; (&lt;code&gt;Boolean&lt;/code&gt;)&lt;/strong&gt;, as there is not subtype association
done by the compiler.&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;generalizing-func-covariance&quot;&gt;Generalizing &lt;code&gt;Func&lt;/code&gt;: Covariance&lt;/h2&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-problem&quot;&gt;The problem&lt;/h3&gt;

&lt;p&gt;Let&amp;#39;s say you handle many &lt;code&gt;Func&lt;/code&gt; implementations:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val x:  Func[Animal, Boolean] = ...
val y:  Func[Animal, String] = ...
val z:  Func[Animal, Int] = ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;p&gt;It would be good to be able to treat all &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt; and &lt;code&gt;z&lt;/code&gt; polymorphically.&lt;/p&gt;

&lt;p&gt;For instance be able to do:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val l: List[Func[Animal, AnyVal]] =
   List(x, y, z) // won't work, invariance
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Our initial declaration of &lt;code&gt;Func[I, O]&lt;/code&gt; was invariant in both &lt;code&gt;I&lt;/code&gt; and &lt;code&gt;O&lt;/code&gt;.
It &lt;strong&gt;does not allow this supertype relation&lt;/strong&gt;.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The solution&lt;/h3&gt;

&lt;p&gt;The solution is &lt;strong&gt;covariance&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The principle: making &lt;code&gt;Clz&lt;/code&gt; covariant in &lt;code&gt;A&lt;/code&gt; means that&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Cat &amp;lt;: Animal&lt;/code&gt; implies&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Clz[Cat] &amp;lt;: Clz[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In other words: the inheritance of this &lt;strong&gt;parametric&lt;/strong&gt; type follows the one from the &lt;strong&gt;parameter&lt;/strong&gt; type.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Back to our example, we simply re-define &lt;code&gt;Func&lt;/code&gt;, but making it covariant in &lt;code&gt;O&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// now covariant on O
class Func[I, +O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// specific type
val isADog: Func[Animal, Boolean] = ...

// generic type
val covIsDogForAnyVal: Func[Animal, AnyVal] =
        isADog   // assigned to a more general type
                 // works because
                 // Boolean &amp;lt;: AnyVal,
                 // and thanks to covariance
                 // Func[X, Boolean] &amp;lt;: Func[X, AnyVal]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;h2 id=&quot;specializing-func-contravariance&quot;&gt;Specializing &lt;code&gt;Func&lt;/code&gt;: Contravariance&lt;/h2&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-problem&quot;&gt;The problem&lt;/h3&gt;

&lt;p&gt;Let&amp;#39;s say we have our function &lt;code&gt;Func[Animal, Boolean]&lt;/code&gt;. Given that &lt;code&gt;Dog &amp;lt;: Animal&lt;/code&gt; (&lt;code&gt;Dog&lt;/code&gt; is a subtype of &lt;code&gt;Animal&lt;/code&gt;),
it seems natural to be able to apply such function to a &lt;code&gt;Dog&lt;/code&gt; too.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The solution&lt;/h3&gt;

&lt;p&gt;The solution is &lt;strong&gt;contravariance&lt;/strong&gt;.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;The principle: making &lt;code&gt;Clz&lt;/code&gt; contravariant in &lt;code&gt;A&lt;/code&gt; means that:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Cat &amp;lt;: Animal&lt;/code&gt; implies&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Clz[Cat] &amp;gt;: Clz[Animal]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In other words the inheritance of this parametric type follows
inversely the one from the parameter type.&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;We simply redefine &lt;code&gt;Func&lt;/code&gt; but making it contravariant in &lt;code&gt;I&lt;/code&gt; this time:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// now contravariant in I
class Func[-I, O] (val f: I =&amp;gt; O) {
  def apply(i: I): O = f(i)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;// generic type
val isDog: Func[Animal, Boolean] =
        new Func((i: Animal) =&amp;gt; i.isInstanceOf[Dog])

// specific type
val contrvarIsDog: Func[Dog, Boolean] =
        isDog // assigned to a more specific type
              // works because
              // Dog &amp;lt;: Animal, and thanks
              // to contravariance
              // Func[Dog, X] &amp;gt;: Func[Animal, X]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;This is the result of applying variances:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%202.%20Covariance%20and%20Contravariance;%0Ascale%20max%20900%20width;%0A%22List%5BAnimal%5D%22%20%3C%7C--%20%22List%5BDog%5D%22:%20%22Covariance%20%5B+A%5D%22;%0A%22List%5BAnimal%5D%22%20%3C%7C--%20%22List%5BCat%5D%22;%0A%22Funct%5BDog%5D%22%20%3C%7C--%20%22Funct%5BAnimal%5D%22:%20%22Contravariance%20%5B-A%5D%22;%0Anote%20left%20of%20%22Funct%5BAnimal%5D%22:%20When%20instanciated,%5Cncan%20be%20reused%5Cnas%20Funct%5BDog%5D%5Cnthanks%20to%5Cncontravariance;%0Anote%20right%20of%20%22List%5BDog%5D%22:%20Can%20be%20added%5Cnto%20a%20List%5BAnimal%5D%5Cnthanks%20to%5Cncovariance;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;See the &lt;a href=&quot;https://docs.scala-lang.org/tour/variances.html&quot;&gt;official Scala documentation on variance&lt;/a&gt;.&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;
</description>
        <pubDate>Tue, 10 Oct 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/10/10/covariant-contravariant-invariant-in-scala/presentation.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/10/10/covariant-contravariant-invariant-in-scala/presentation.html</guid>
        
        <category>scala</category>
        
        <category>types</category>
        
        <category>covariant</category>
        
        <category>contravariant</category>
        
        <category>invariant</category>
        
        
      </item>
    
      <item>
        <title>JVM Memory Spaces</title>
        <description>&lt;p&gt;This post addresses:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what are Java Memory Spaces&lt;/li&gt;
&lt;li&gt;why they are such a good idea&lt;/li&gt;
&lt;li&gt;their names and use in the JVM&lt;/li&gt;
&lt;li&gt;how to measure their usage in practice&lt;/li&gt;
&lt;li&gt;where to find more documentation about them&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;So, if you don&amp;#39;t understand concepts like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OutOfMemoryError&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PermGen&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;heap memory&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Then I suggest you to continue reading!&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;why-the-need-for-memory-spaces&quot;&gt;Why the need for Memory Spaces?&lt;/h2&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;The JVM frees unreferenced memory via an entity called Garbage Collector (or GC for short).
Every time the GC claims memory, it executes these steps:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20The%20steps%20of%20the%20Garbage%20Collection%20(GC);%0Ascale%20max%20900%20width;%0A;%0A(*)%20-right-%3E%20%221.%20Mark%20used%20memory%22%20%23white;%0A-right-%3E%20%222.%20Delete%20unused%20memory%22%20%23white;%0A-right-%3E%20%223.%20Compact%20used%20memory%22%20%23white;%0A-right-%3E%20(*);%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;If these steps were to be applied to a flat memory space, the process of freeing memory would become
proportionally as slow as the amount of memory used. In other words, the more classes loaded, the more
memory segments to explore every time memory is claimed.&lt;/p&gt;

&lt;p&gt;As you could imagine, things get better if the GC is aware of the odds an object is eligible for disposal.&lt;/p&gt;

&lt;p&gt;In a simplified version of reality, the GC considers a class object to be permanent (as it will probably
live as long as the JVM).&lt;/p&gt;

&lt;p&gt;On the other hand, the GC considers objects created with the &lt;em&gt;new&lt;/em&gt; keyword as
more likely to have shorter life. The GC discriminates &lt;em&gt;very short life&lt;/em&gt; from &lt;em&gt;medium life&lt;/em&gt; and &lt;em&gt;long life&lt;/em&gt;
by keeping count of the amount of times an object survived a GC cycle. Objects survive a GC cycle when they
are still referenced (hence their block of memory is marked, preventing it from disposal).&lt;/p&gt;

&lt;p&gt;Objects that survived some GC cycles are less eligible for disposal soon, and we can say they change
their &lt;em&gt;generation&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;This categorisation of objects into generations really exists, and is materialised in JVMs via Memory Spaces,
or more precisely &lt;em&gt;Generational Memory Spaces&lt;/em&gt;.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;what-are-the-memory-spaces-in-java&quot;&gt;What are the Memory Spaces in Java?&lt;/h2&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;Strictly speaking, the Java Memory Spaces really depend on the Java VM implementation, but in general
terms they can be divided into:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%202.%20Java%20Memory%20Spaces%20(MP%20stands%20for%20Memory%20Pool);%0Ascale%20max%20900%20width;%0Arectangle%20%22JVM%20Memory%22%20%7B;%0A%20%20rectangle%20%22Heap%22%20%7B;%0A%20%20%20%20rectangle%20%22Young%5CnGeneration%22%20%7B;%0A%20%20%20%20%20%20rectangle%20eden%20as%20%22MP%20PS%5CnEden%5CnSpace%22%20%23red;%0A%20%20%20%20%20%20rectangle%20survivor%20as%20%22MP%20PS%5CnSurvivor%5CnSpace%22%20%23orange;%0A%20%20%20%20%7D;%0A%20%20%20%20rectangle%20%22Old%5CnGeneration%22%20%7B;%0A%20%20%20%20%20%20rectangle%20oldgen%20as%20%22MP%20PS%5CnOld%20Gen%22%20%23blue;%0A%20%20%20%20%7D;%0A%20%20%7D;%0A%20%20rectangle%20OffHeap%20%7B;%0A%20%20%20%20rectangle%20metaspace%20as%20%22MP%5CnMetaspace%22;%0A%20%20%20%20rectangle%20codecache%20as%20%22MP%5CnCodecache%22;%0A%20%20%20%20rectangle%20classspace%20as%20%22MP%5CnCompressed%5CnClass%20Space%22;%0A%20%20%7D;%0A%7D;%0Anote%20right%20of%20OffHeap%20%23white;%0A%20%20Not%20subject%20to%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20Heap%20%23white;%0A%20%20All%20object%20instances;%0A%20%20are%20stored%20here,;%0A%20%20memory%20from%20this;%0A%20%20space%20is%20used%20whenever;%0A%20%20new%20is%20present%20in%20the;%0A%20%20code.;%0A%20%20Subject%20to%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20metaspace%20%23white;%0A%20%20It%20used%20to%20be;%0A%20%20PermGen%20before;%0A%20%20Java%208.;%0Aend%20note;%0A;%0Anote%20right%20of%20codecache%20%23white;%0A%20%20Contains%20compiled;%0A%20%20native%20code,%20mostly;%0A%20%20used%20by%20the%20JIT.;%0Aend%20note;%0A;%0Anote%20right%20of%20eden%20%23white;%0A%20%20%20Recently%20allocated;%0A%20%20%20objects,%20did%20not;%0A%20%20%20survive%20any%20GC%20yet.;%0Aend%20note;%0A;%0Anote%20right%20of%20survivor%20%23white;%0A%20%20%20Objects%20that%20have;%0A%20%20%20survived%20at%20least;%0A%20%20%20one%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20oldgen%20%23white;%0A%20%20Also%20called%20Tenured,;%0A%20%20objects%20that%20have;%0A%20%20survived%20some%20time;%0A%20%20in%20the%20Survivor%20Space.;%0Aend%20note;%0A;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;no-permgen-space-in-jdk-8&quot;&gt;No PermGen Space in JDK 8?&lt;/h3&gt;

&lt;p&gt;Exactly, no more &lt;code&gt;PermGen&lt;/code&gt;. &lt;/p&gt;

&lt;p&gt;In JDK 8 the permanent generation was removed. The class metadata is allocated in native memory instead.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;The amount of native memory that can be used for class metadata is by default unlimited. You can use the option &lt;code&gt;MaxMetaspaceSize&lt;/code&gt; to put an upper limit on it.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;in-practice-can-i-measure-the-use-of-memory-spaces&quot;&gt;In practice, can I measure the use of Memory Spaces?&lt;/h2&gt;

&lt;p&gt;You can use &lt;code&gt;jconsole&lt;/code&gt; for that. This tool will show you:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the use of Memory Spaces&lt;/li&gt;
&lt;li&gt;the threads in your JVM (with name, status, stacktrace, etc.)&lt;/li&gt;
&lt;li&gt;loaded classes&lt;/li&gt;
&lt;li&gt;exposed MBeans&lt;/li&gt;
&lt;li&gt;and more!&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;example&quot;&gt;Example&lt;/h3&gt;

&lt;p&gt;We will use the Scala REPL as an example: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;scala
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We will open &lt;code&gt;jconsole&lt;/code&gt; and hook to the just launched JVM (using its PID).&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;jconsole &amp;lt;PID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to hook to the corresponding JVM.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;What I see initially is:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/jconsole1.png&quot; style=&quot;width:800px;height:600px;&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;However, if you perform a GC and then you create lots of objects with:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val a = (1 to 1000000).toList.map(_.toString)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;You will see:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/jconsole2.png&quot; style=&quot;width:800px;height:600px;&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Can you explain:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what happens to the &lt;em&gt;Heap Memory Usage&lt;/em&gt; when we launched the GC? It drops, used memory was marked, letting GC dispose unused blocks of memory, freing it for new objects to use it.&lt;/li&gt;
&lt;li&gt;what happens when we created objects in Scala? See how the heap usage increases by about 100MiB. There is one new big object &lt;code&gt;val a&lt;/code&gt; allocated.&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;And more generally:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what happens to the Loaded classes? They increased by the team &lt;code&gt;val a&lt;/code&gt; was instantiated given the lazy class loading.&lt;/li&gt;
&lt;li&gt;what happens to the use of CPU? There is a peak when &lt;code&gt;val a&lt;/code&gt; was instantiated. Can you see it?&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;There is really lots of documentation about this topic. Whenever you read documentation about it, I suggest you to
double check the version of the JVM it relates too.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/en/java/&quot;&gt;General documentation from Oracle about Java&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html&quot;&gt;Java Garbage Collection Basics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/7/&quot;&gt;JAVA SE 7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/8/&quot;&gt;JAVA SE 8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/9/&quot;&gt;JAVA SE 9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Also, do not forget &lt;code&gt;man java&lt;/code&gt;. If java was not installed properly via a package manager, you can still try to read the manual with &lt;code&gt;man&lt;/code&gt;. For example: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;man --manpath /home/mjost/opt/zips/jdk1.7.0_79/man java
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;p&gt;Enjoy!&lt;/p&gt;
</description>
        <pubDate>Thu, 17 Aug 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/08/17/jvm-memory-spaces/post.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/08/17/jvm-memory-spaces/post.html</guid>
        
        <category>scala</category>
        
        <category>java</category>
        
        <category>heap</category>
        
        <category>memory</category>
        
        <category>permgen</category>
        
        
      </item>
    
      <item>
        <title>JVM Memory Spaces</title>
        <description>&lt;p&gt;This post addresses:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what are Java Memory Spaces&lt;/li&gt;
&lt;li&gt;why they are such a good idea&lt;/li&gt;
&lt;li&gt;their names and use in the JVM&lt;/li&gt;
&lt;li&gt;how to measure their usage in practice&lt;/li&gt;
&lt;li&gt;where to find more documentation about them&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;So, if you don&amp;#39;t understand concepts like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OutOfMemoryError&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PermGen&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;heap memory&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Then I suggest you to continue reading!&lt;/p&gt;

&lt;!--slide-next--&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;why-the-need-for-memory-spaces&quot;&gt;Why the need for Memory Spaces?&lt;/h2&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;The JVM frees unreferenced memory via an entity called Garbage Collector (or GC for short).
Every time the GC claims memory, it executes these steps:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%201.%20The%20steps%20of%20the%20Garbage%20Collection%20(GC);%0Ascale%20max%20900%20width;%0A;%0A(*)%20-right-%3E%20%221.%20Mark%20used%20memory%22%20%23white;%0A-right-%3E%20%222.%20Delete%20unused%20memory%22%20%23white;%0A-right-%3E%20%223.%20Compact%20used%20memory%22%20%23white;%0A-right-%3E%20(*);%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;If these steps were to be applied to a flat memory space, the process of freeing memory would become
proportionally as slow as the amount of memory used. In other words, the more classes loaded, the more
memory segments to explore every time memory is claimed.&lt;/p&gt;

&lt;p&gt;As you could imagine, things get better if the GC is aware of the odds an object is eligible for disposal.&lt;/p&gt;

&lt;p&gt;In a simplified version of reality, the GC considers a class object to be permanent (as it will probably
live as long as the JVM).&lt;/p&gt;

&lt;p&gt;On the other hand, the GC considers objects created with the &lt;em&gt;new&lt;/em&gt; keyword as
more likely to have shorter life. The GC discriminates &lt;em&gt;very short life&lt;/em&gt; from &lt;em&gt;medium life&lt;/em&gt; and &lt;em&gt;long life&lt;/em&gt;
by keeping count of the amount of times an object survived a GC cycle. Objects survive a GC cycle when they
are still referenced (hence their block of memory is marked, preventing it from disposal).&lt;/p&gt;

&lt;p&gt;Objects that survived some GC cycles are less eligible for disposal soon, and we can say they change
their &lt;em&gt;generation&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;This categorisation of objects into generations really exists, and is materialised in JVMs via Memory Spaces,
or more precisely &lt;em&gt;Generational Memory Spaces&lt;/em&gt;.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;what-are-the-memory-spaces-in-java&quot;&gt;What are the Memory Spaces in Java?&lt;/h2&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;Strictly speaking, the Java Memory Spaces really depend on the Java VM implementation, but in general
terms they can be divided into:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;https://g.gravizo.com/svg?%0A@startuml;%0Askinparam%20monochrome%20false;%0Acaption%20Figure%202.%20Java%20Memory%20Spaces%20(MP%20stands%20for%20Memory%20Pool);%0Ascale%20max%20900%20width;%0Arectangle%20%22JVM%20Memory%22%20%7B;%0A%20%20rectangle%20%22Heap%22%20%7B;%0A%20%20%20%20rectangle%20%22Young%5CnGeneration%22%20%7B;%0A%20%20%20%20%20%20rectangle%20eden%20as%20%22MP%20PS%5CnEden%5CnSpace%22%20%23red;%0A%20%20%20%20%20%20rectangle%20survivor%20as%20%22MP%20PS%5CnSurvivor%5CnSpace%22%20%23orange;%0A%20%20%20%20%7D;%0A%20%20%20%20rectangle%20%22Old%5CnGeneration%22%20%7B;%0A%20%20%20%20%20%20rectangle%20oldgen%20as%20%22MP%20PS%5CnOld%20Gen%22%20%23blue;%0A%20%20%20%20%7D;%0A%20%20%7D;%0A%20%20rectangle%20OffHeap%20%7B;%0A%20%20%20%20rectangle%20metaspace%20as%20%22MP%5CnMetaspace%22;%0A%20%20%20%20rectangle%20codecache%20as%20%22MP%5CnCodecache%22;%0A%20%20%20%20rectangle%20classspace%20as%20%22MP%5CnCompressed%5CnClass%20Space%22;%0A%20%20%7D;%0A%7D;%0Anote%20right%20of%20OffHeap%20%23white;%0A%20%20Not%20subject%20to%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20Heap%20%23white;%0A%20%20All%20object%20instances;%0A%20%20are%20stored%20here,;%0A%20%20memory%20from%20this;%0A%20%20space%20is%20used%20whenever;%0A%20%20new%20is%20present%20in%20the;%0A%20%20code.;%0A%20%20Subject%20to%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20metaspace%20%23white;%0A%20%20It%20used%20to%20be;%0A%20%20PermGen%20before;%0A%20%20Java%208.;%0Aend%20note;%0A;%0Anote%20right%20of%20codecache%20%23white;%0A%20%20Contains%20compiled;%0A%20%20native%20code,%20mostly;%0A%20%20used%20by%20the%20JIT.;%0Aend%20note;%0A;%0Anote%20right%20of%20eden%20%23white;%0A%20%20%20Recently%20allocated;%0A%20%20%20objects,%20did%20not;%0A%20%20%20survive%20any%20GC%20yet.;%0Aend%20note;%0A;%0Anote%20right%20of%20survivor%20%23white;%0A%20%20%20Objects%20that%20have;%0A%20%20%20survived%20at%20least;%0A%20%20%20one%20GC.;%0Aend%20note;%0A;%0Anote%20right%20of%20oldgen%20%23white;%0A%20%20Also%20called%20Tenured,;%0A%20%20objects%20that%20have;%0A%20%20survived%20some%20time;%0A%20%20in%20the%20Survivor%20Space.;%0Aend%20note;%0A;%0A@enduml;&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;no-permgen-space-in-jdk-8&quot;&gt;No PermGen Space in JDK 8?&lt;/h3&gt;

&lt;p&gt;Exactly, no more &lt;code&gt;PermGen&lt;/code&gt;. &lt;/p&gt;

&lt;p&gt;In JDK 8 the permanent generation was removed. The class metadata is allocated in native memory instead.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;The amount of native memory that can be used for class metadata is by default unlimited. You can use the option &lt;code&gt;MaxMetaspaceSize&lt;/code&gt; to put an upper limit on it.&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;in-practice-can-i-measure-the-use-of-memory-spaces&quot;&gt;In practice, can I measure the use of Memory Spaces?&lt;/h2&gt;

&lt;p&gt;You can use &lt;code&gt;jconsole&lt;/code&gt; for that. This tool will show you:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the use of Memory Spaces&lt;/li&gt;
&lt;li&gt;the threads in your JVM (with name, status, stacktrace, etc.)&lt;/li&gt;
&lt;li&gt;loaded classes&lt;/li&gt;
&lt;li&gt;exposed MBeans&lt;/li&gt;
&lt;li&gt;and more!&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;h3 id=&quot;example&quot;&gt;Example&lt;/h3&gt;

&lt;p&gt;We will use the Scala REPL as an example: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;scala
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We will open &lt;code&gt;jconsole&lt;/code&gt; and hook to the just launched JVM (using its PID).&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;jconsole &amp;lt;PID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to hook to the corresponding JVM.&lt;/p&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;What I see initially is:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/jconsole1.png&quot; style=&quot;width:800px;height:600px;&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;However, if you perform a GC and then you create lots of objects with:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-&quot; data-lang=&quot;&quot;&gt;val a = (1 to 1000000).toList.map(_.toString)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-down--&gt;

&lt;!--slide-ignore-begin--&gt;

&lt;p&gt;You will see:&lt;/p&gt;

&lt;!--slide-ignore-end--&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/jconsole2.png&quot; style=&quot;width:800px;height:600px;&quot;&gt;&lt;/p&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Can you explain:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what happens to the &lt;em&gt;Heap Memory Usage&lt;/em&gt; when we launched the GC? It drops, used memory was marked, letting GC dispose unused blocks of memory, freing it for new objects to use it.&lt;/li&gt;
&lt;li&gt;what happens when we created objects in Scala? See how the heap usage increases by about 100MiB. There is one new big object &lt;code&gt;val a&lt;/code&gt; allocated.&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;And more generally:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;what happens to the Loaded classes? They increased by the team &lt;code&gt;val a&lt;/code&gt; was instantiated given the lazy class loading.&lt;/li&gt;
&lt;li&gt;what happens to the use of CPU? There is a peak when &lt;code&gt;val a&lt;/code&gt; was instantiated. Can you see it?&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-next--&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;There is really lots of documentation about this topic. Whenever you read documentation about it, I suggest you to
double check the version of the JVM it relates too.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/en/java/&quot;&gt;General documentation from Oracle about Java&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html&quot;&gt;Java Garbage Collection Basics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/7/&quot;&gt;JAVA SE 7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/8/&quot;&gt;JAVA SE 8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javase/9/&quot;&gt;JAVA SE 9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!--slide-down--&gt;

&lt;p&gt;Also, do not forget &lt;code&gt;man java&lt;/code&gt;. If java was not installed properly via a package manager, you can still try to read the manual with &lt;code&gt;man&lt;/code&gt;. For example: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;man --manpath /home/mjost/opt/zips/jdk1.7.0_79/man java
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!--slide-next--&gt;

&lt;p&gt;Enjoy!&lt;/p&gt;
</description>
        <pubDate>Thu, 17 Aug 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/08/17/jvm-memory-spaces/presentation.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/08/17/jvm-memory-spaces/presentation.html</guid>
        
        <category>scala</category>
        
        <category>java</category>
        
        <category>heap</category>
        
        <category>memory</category>
        
        <category>permgen</category>
        
        
      </item>
    
      <item>
        <title>Measuring the Performance of Anything In Scala</title>
        <description>&lt;h2 id=&quot;why-benchmarking&quot;&gt;Why benchmarking?&lt;/h2&gt;

&lt;p&gt;Coding consciously and the use of code reviews are of great importance when it comes to writing clean and efficient code.
But sometimes I feel like I need stronger proofs to go one way or another, specially when I don&amp;#39;t really know what is 
happening under the JVM hood.&lt;/p&gt;

&lt;p&gt;A number describing the current status of your implementation will let you firstly gain awareness, 
secondly decide if improvement is worth the investment, 
and finally measure the improvement of your change. But it is not so easy...&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;what-is-the-problem-with-it&quot;&gt;What is the problem with it?&lt;/h2&gt;

&lt;p&gt;When it comes to performance of an algorithm, we can get such metric by doing &lt;strong&gt;benchmarking&lt;/strong&gt;. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;What can be so complicated about it? Just launch the algorithm many times and measure its execution time, and voila!!!&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Nope, benchmarking is not so trivial, specially on top of JVM. Scala by itself applies more than 
&lt;a href=&quot;https://wiki.scala-lang.org/display/SIW/Overview+of+Compiler+Phases&quot;&gt;15 phases&lt;/a&gt; when 
compiling trying to optimize the algorithm, and the JVM can also apply very clever optimizations at run time, leading to a (very) fooled conclusion.&lt;/p&gt;

&lt;p&gt;For instance, try to explain why the comparative benchmark set
&lt;a href=&quot;https://mauriciojost.github.io/scala-benchmark/&quot;&gt;org.mauritania.minibenchmark.catalog.IdentityTricky&lt;/a&gt; 
below (the suspiciously even one) yields such unexpected results for 
&lt;a href=&quot;https://github.com/mauriciojost/scala-benchmark/blob/master/src/main/scala/org/mauritania/minibenchmark/catalog/IdentityTricky.scala&quot;&gt;these very different algorithms&lt;/a&gt;. 
Found the reason?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://mauriciojost.github.io/scala-benchmark/&quot;&gt;&lt;img src=&quot;/images/posts/scala-benchmark.png&quot; alt=&quot;Project&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;and-the-solution&quot;&gt;And the solution?&lt;/h2&gt;

&lt;p&gt;The one I recommend is to use &lt;a href=&quot;http://openjdk.java.net/projects/code-tools/jmh/&quot;&gt;JMH&lt;/a&gt;, the harness for Java benchmarking that is 
exploitable from Scala thanks to &lt;a href=&quot;https://github.com/ktoso/sbt-jmh&quot;&gt;sbt-jmh&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;how-to-get-started-right-now&quot;&gt;How to get started right now?&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;I&amp;#39;ve set up a &lt;a href=&quot;https://github.com/mauriciojost/scala-benchmark&quot;&gt;project github/scala-benchmark&lt;/a&gt; which 
renders &lt;a href=&quot;https://mauriciojost.github.io/scala-benchmark/&quot;&gt;visual reports&lt;/a&gt; that GitHub can display via GitHub pages.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;Also if you want to know more, I really recommend &lt;a href=&quot;http://tutorials.jenkov.com/java-performance/jmh.html&quot;&gt;this read about JMH&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;
</description>
        <pubDate>Wed, 19 Apr 2017 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2017/04/19/benchmarking-in-scala.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/04/19/benchmarking-in-scala.html</guid>
        
        <category>scala</category>
        
        <category>performance</category>
        
        <category>benchmark</category>
        
        <category>api</category>
        
        <category>collections</category>
        
        <category>jmh</category>
        
        
      </item>
    
      <item>
        <title>Sorting Anything Cleanly with Scala</title>
        <description>&lt;h2 id=&quot;why-sorting&quot;&gt;Why sorting?&lt;/h2&gt;

&lt;p&gt;Sorting requirements are present in the vast majority of data processing applications. As Scala provides very good tools for addressing them, I thought it would be interesting to dive a bit into them to improve our code.&lt;/p&gt;

&lt;p&gt;Here are some of the patterns that you may feel tempted to use, and what I consider is a better alternative. Leave a comment if you have even a better one!&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;basic-sorting&quot;&gt;Basic sorting&lt;/h2&gt;

&lt;p&gt;Let&amp;#39;s use the below as our example collection (you can try this out in the scala-shell):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;get-an-extreme-value-max&quot;&gt;Get an extreme value: &lt;code&gt;max&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;If you feel tempted to do:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toSeq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;just don&amp;#39;t, &lt;strong&gt;you better do&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Why?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Apart from being simpler and easier to read, it&amp;#39;s also more efficient
(as no intermediate collection will be created).&lt;/p&gt;

&lt;h3 id=&quot;keep-sorted&quot;&gt;Keep sorted&lt;/h3&gt;

&lt;p&gt;Some usecases require to keep a collection sorted at all times.&lt;/p&gt;

&lt;p&gt;If you feel tempted to do:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toSeq&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sorted&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;just don&amp;#39;t, &lt;strong&gt;you better do&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scala.collection.SortedSet&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SortedSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted2&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// sorted
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sorted3&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// sorted
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Why?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Apart from being cleaner, it&amp;#39;s also more efficient as (no intermediate non-sorted collections are created).&lt;/p&gt;

&lt;p&gt;Mind though, that &lt;code&gt;Set&lt;/code&gt; is not suitable if you need your collection to keep duplicate elements.&lt;/p&gt;

&lt;h2 id=&quot;sorting-complex-types-ordering&quot;&gt;Sorting complex types: &lt;code&gt;Ordering&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;Many scenarios with more complex types require some sort of functional definition of the ordering.&lt;/p&gt;

&lt;p&gt;What if we have more complex types? For instance: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;savings&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;hasKids&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Adam&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
   &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Charles&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
   &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Adam&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can say that &lt;em&gt;there is no implicit Ordering defined for Person&lt;/em&gt;. As Person is part of our business,
its up to us to define its &lt;em&gt;Ordering&lt;/em&gt;, which we can do easily as follows: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderingOnSavings&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ordering&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ordering&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderingOnSavings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Person(-1, &quot;Adam&quot;, true)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Keep in mind that there is an implicit ordering defined for the type &lt;code&gt;Int&lt;/code&gt; and that&amp;#39;s why this works. 
Scala also has an implicit ordering defined for tuples of types for which there is an implicit ordering, which includes
primitive types such as &lt;code&gt;Int&lt;/code&gt;, &lt;code&gt;String&lt;/code&gt;, &lt;code&gt;Double&lt;/code&gt; and so on.&lt;/p&gt;

&lt;p&gt;Thanks to this we can specify a multi-field ordering with a given priority, as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderingOSavingsAndSurname&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Ordering&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;Ordering&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// uses imp. ordering
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderingOSavingsAndSurname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Person(1, &quot;Charles&quot;, true)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using &lt;strong&gt;Orderings&lt;/strong&gt; your code will become:
 - much cleaner,
 - robust,
 - reusable and
 - testable&lt;/p&gt;

&lt;h1 id=&quot;enjoy&quot;&gt;Enjoy!&lt;/h1&gt;
</description>
        <pubDate>Tue, 28 Feb 2017 23:00:00 +0100</pubDate>
        <link>http://mauriciojost.github.io/2017/02/28/sorting-anything-cleanly-with-scala.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2017/02/28/sorting-anything-cleanly-with-scala.html</guid>
        
        <category>scala</category>
        
        <category>sorting</category>
        
        <category>orderings</category>
        
        <category>api</category>
        
        <category>max</category>
        
        <category>min</category>
        
        
      </item>
    
      <item>
        <title>Serializing (almost) Anything with Kryo (for Spark)</title>
        <description>&lt;h2 id=&quot;what-is-kryo&quot;&gt;What is Kryo?&lt;/h2&gt;

&lt;p&gt;Kryo serialization is one of the fastest on-JVM serialization libraries, and it is certainly the most popular in the Spark world.&lt;/p&gt;

&lt;p&gt;To get the most out of this algorithm you must register the few classes that will have to be serialized. This will help to decrease the size of serialized objects, as their serialization will be tailor-made optimized by Kryo.&lt;/p&gt;

&lt;p&gt;Registering your classes with Kryo in Spark is done this way:&lt;/p&gt;

&lt;!--more--&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sparkConf&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SparkConf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sparkConf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;registerKryoClasses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;nc&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
       &lt;span class=&quot;c1&quot;&gt;// your classes here
&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;how-to-serialize-unaccessible-classes&quot;&gt;How to serialize unaccessible classes?&lt;/h2&gt;

&lt;p&gt;It all goes fine until you hit private classes, or arrays of classes. If you tried to serialize classes from the Joda library probably you know what I am talking about. However there are a few tricks that will help you serialize almost anything:  &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// scala basic classes
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scala.collection.immutable.$colon$colon&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scala.collection.immutable.Nil$&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Tuple2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;,&lt;span class=&quot;k&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// arrays of primitive classes
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// monads of primitive classes
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Boolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// case objects
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scala.None$&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// protected static final classes
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;ClassTag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.roaringbitmap.RoaringArray$Element&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtimeClass&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// public static class FakeFileStatus
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&quot;org.apache.spark.sql.sources.HadoopFsRelation$FakeFileStatus&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;ClassTag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&quot;org.apache.spark.sql.sources.HadoopFsRelation$FakeFileStatus&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtimeClass&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// joda classes
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;org.joda.time.tz.DateTimeZoneBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;org.joda.time.tz.FixedDateTimeZone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.DateTimeZoneBuilder$PrecalculatedZone&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.DateTimeZoneBuilder$DSTZone&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.DateTimeZoneBuilder$Recurrence&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.DateTimeZoneBuilder$OfYear&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.CachedDateTimeZone$Info&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;ClassTag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&quot;org.joda.time.tz.CachedDateTimeZone$Info&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runtimeClass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Won&amp;#39;t you serialize anything?&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Oct 2016 23:00:00 +0100</pubDate>
        <link>http://mauriciojost.github.io/2016/10/31/serializing-almost-anything-with-kryo.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2016/10/31/serializing-almost-anything-with-kryo.html</guid>
        
        <category>spark</category>
        
        <category>kryo</category>
        
        <category>serialization</category>
        
        <category>register</category>
        
        <category>class</category>
        
        <category>private</category>
        
        
      </item>
    
      <item>
        <title>Partial Functions in Scala</title>
        <description>&lt;h2 id=&quot;what-is-a-partial-function&quot;&gt;What is a partial function?&lt;/h2&gt;

&lt;p&gt;In short, a partial function is simply a mathematical function &lt;em&gt;f: X-&amp;gt;Y&lt;/em&gt; that is not defined for some elements in the domain &lt;em&gt;X&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;The typical example is &lt;em&gt;f: 1/x&lt;/em&gt; , not defined when &lt;em&gt;x = 0&lt;/em&gt;.&lt;/p&gt;

&lt;h2 id=&quot;but-what-is-a-partial-function-in-scala&quot;&gt;But, what is a partial function in Scala?&lt;/h2&gt;

&lt;p&gt;It is a Scala trait that allows to express a partial function. For instance...&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;The previous example would be expressed as: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isDefinedAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or more concisely (using pattern matching):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positives&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;why-should-i-use-it&quot;&gt;Why should I use it?&lt;/h2&gt;

&lt;h3 id=&quot;because-they-are-extensively-used-in-the-scala-api&quot;&gt;Because they are extensively used in the Scala API&lt;/h3&gt;

&lt;p&gt;Really. For instance, the root of all collections (the trait Traversable) defines the method&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pf&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;X&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Traversable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;that allows to create a List[Y] from some elements of a List[X]. Knowing the API will let you have more choices when tackling a problem and surely be a better developer.&lt;/p&gt;

&lt;h3 id=&quot;because-they-are-efficient&quot;&gt;Because they are efficient&lt;/h3&gt;

&lt;p&gt;Consider the function &lt;em&gt;f: x.toString&lt;/em&gt; where &lt;em&gt;x &amp;gt; 0&lt;/em&gt; similar to the one I mentioned above. This could be expressed as: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positivesAsStrings&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; 
      &lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But there is something nasty about it. After the filter call, Scala will create an intermediate collection on which it will apply the map call. If your intermediate collection is large (lets say you have a million of integers and a high percentage is positive) you will waste time creating this discardable intermediate object.
However, if using collect(partialFunction) instead, we will be populating the the final collection right away. Think of the amount of garbage collection you could save!&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positivesAsStringsPF&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positivesAsStrings&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; 
      &lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positivesAsStringsPF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;because-they-ease-modularization-and-can-be-combined&quot;&gt;Because they ease modularization and can be combined&lt;/h3&gt;

&lt;p&gt;When using pattern matching we use blocks like this one:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;asString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;default&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here we provide the domain on which we want to apply a function (on defined monads, and also undefined monads in this case), and the function itself for each case. For the sake of modularization, this can be expressed as a set of partial functions combined together:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-scala&quot; data-lang=&quot;scala&quot;&gt;&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pfForSome&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;asString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pfForNone&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pfForSomeAndNone&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PartialFunction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; 
      &lt;span class=&quot;n&quot;&gt;pfForSome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pfForNone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultAsOption&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Option&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; 
      &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pfForSomeAndNone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;want-to-know-more&quot;&gt;Want to know more?&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://blog.bruchez.name/2011/10/scala-partial-functions-without-phd.html&quot;&gt;I really liked this post&lt;/a&gt;, I encourage you to take a look.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Won&amp;#39;t you partial-function-ize anything?&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 01 Sep 2016 00:00:00 +0200</pubDate>
        <link>http://mauriciojost.github.io/2016/09/01/partial-functions-in-scala.html</link>
        <guid isPermaLink="true">http://mauriciojost.github.io/2016/09/01/partial-functions-in-scala.html</guid>
        
        <category>scala</category>
        
        <category>partial</category>
        
        <category>functions</category>
        
        <category>collect</category>
        
        <category>collections</category>
        
        
      </item>
    
  </channel>
</rss>
